<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>検索テスト</title>
</head>
<body>
  <textarea id="text" rows="4" cols="40">
JavaScriptで文字列検索をして、検索ヒット数を数えます。
JavaScriptの練習です。
  </textarea>
  <br>
  <input type="text" id="keyword" placeholder="検索キーワード">
  <button id="searchBtn">検索</button>
  <p>ヒット数: <span id="count">0</span></p>

  <script>
    const textArea = document.getElementById("text");
    const keywordInput = document.getElementById("keyword");
    const searchBtn = document.getElementById("searchBtn");
    const countSpan_2 = document.getElementById("count");

    searchBtn.addEventListener("click", () => {
      const text = textArea.value; //テキストエリアの中の文章を text という変数に入れる。
      const keyword = keywordInput.value; //検索したい文字 を取得して keyword に入れる

      // 検索キーワードが空（未入力）だった場合の処理。キーワード未入力なら0で終了
      if (!keyword) {
        countSpan_2.textContent = 0;
        return;
      }

      const parts = text.split(keyword);
      const hits = parts.length - 1;
      countSpan_2.textContent = hits;
    });
  </script>
</body>
</html>

<!-- split() は 文字列を分割するメソッド。 -->
<!-- text = "abcXYZdefXYZghi" -->
<!-- keyword = "XYZ" -->
<!-- 上の例なら -->
<!-- text.split("XYZ") は 以下のようになる -->
<!-- ["abc", "def", "ghi"] -->

<!-- const hits = parts.length - 1; -->
<!-- 分割してできた配列の要素数（parts.length）から1引いた値がヒット数になる。 -->
<!-- ["abc", "def", "ghi"] → length = 3 -->
<!-- hits = 3 - 1 = 2 -->

<!-- countSpan.textContent = hits; -->
<!-- <span id="count">0</span> -->
<!-- に検索結果（ヒット数）を書き込む。 -->





<!-- ある程度スクロールしたら「ページトップへ」ボタンを表示し、 -->
<!-- クリックしたらページの一番上に戻るようにしてください。 -->
<style>
#toTop {
  position: fixed;
  right: 20px;
  bottom: 20px;
  display: none;
}
</style>

<div style="height:1500px;">
  スクロールしてください
</div>

<button id="toTop">ページトップへ</button>

<script>
const toTopBtn = document.getElementById("toTop");

window.addEventListener("scroll", () => {
  if (window.scrollY > 200) {
    toTopBtn.style.display = "block"; //スクロール量が200pxより大きい場合ボタンを表示する。
  } else {
    toTopBtn.style.display = "none"; //スクロール量が200px以下の場合ボタンを隠す。
  }
});
//ページのスクロール位置を変更する関数。
toTopBtn.addEventListener("click", () => {
  window.scrollTo({
    top: 0,//ページの一番上へ移動
    behavior: "smooth"
  });
});
</script>



<!-- 「開く」ボタンを押すとモーダルを表示し、
「閉じる」ボタンを押すとモーダルを閉じてください。 -->

<button id="openModal">開く</button>

<div id="modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5);">
  <div style="background:#fff; margin:100px auto; padding:20px; width:300px;">
    <p>モーダルの中身です</p>
    <button id="closeModal">閉じる</button>
  </div>
</div>
<script>
  const openModal = document.getElementById("openModal");
  const closeModal = document.getElementById("closeModal");
  const modal = document.getElementById("modal");

  openModal.addEventListener("click", () => {
    modal.style.display = "block";
  });
  closeModal.addEventListener("click", () => {
    modal.style.display = "none";
  });
</script>


<br>
<!-- textarea に最大 50文字まで入力可能
入力するたびに「残り○文字」と表示
50文字を超えたら、それ以上入力できないようにする -->
<textarea id="msg" placeholder="メッセージを入力（最大50文字）"></textarea>
<p>残り文字数:<span id="remain">50</span></p>
<script>
  const msg = document.getElementById("msg");
  const remain = document.getElementById("remain");
  const maxLen = 50;

  msg.addEventListener("input", () => {
    let text = msg.value //textarea に入力されている文字列を取得
    //入力文字数が上限を超えていたら
    if (text.length > maxLen) {
      text = text.slice(0, maxLen);
      msg.value = text;
    }

    const left = maxLen - text.length; //残り文字数の計算
    remain.textContent = left;

  });
</script>

<!-- "ABCDEFG".slice(0, 3) // → "ABC" -->

<!-- text.slice(0, maxLen) -->
<!-- 最初の50文字だけ残して、それ以降は切り捨てる -->

<!-- msg.value = text; -->
<!-- textarea の中身を強制的に切り取った内容に書き換える -->
<!-- これがあるから上限超えて入力しても -->
<!-- 自動的に文字数が戻る（貼り付け対策にもなる） -->

<!-- remain.textContent = left; -->
<!-- HTMLの残り文字数表示部分： -->
<!-- <span id="remain">50</span> -->
<!-- これを リアルタイムで left（残り文字数）に更新。 -->




<!-- ボタンを押すと背景色がランダムに変わる -->
<button id="changeColor">色を変える</button>
<script>
  const changeBtn = document.getElementById("changeColor");
  const colors = ["red", "blue", "green", "orange", "pink"];

  changeBtn.addEventListener("click", () => {
    const index = Math.floor(Math.random() * colors.length);
    document.body.style.backgroundColor = colors[index];
  });

</script>


<!-- Math.random()
0以上1未満のランダムな小数を返す。 -->

<!-- colors.length → 5 -->

<!-- Math.random() * colors.length
例：Math.random() が 0.6 のとき、
0.6 * 5 = 3.0 -->

<!-- Math.floor(...)
floor = 小数点以下を切り捨てる。 -->


<!-- document.body.style.backgroundColor = colors[index]; -->
<!-- document.body → 画面全体の <body> -->
<!-- その背景色 (backgroundColor) をランダムに選んだ色で変更。 -->
<!-- 例：
index = 0 → colors[0] = "red"
index = 3 → colors[3] = "orange" -->


<br>


<!-- 仕様
「表示」ボタンを押すとアラートメッセージを表示
3秒後に自動で非表示になる -->
<button id="showAlert">表示</button>
<p id="alert" style="display: none;">
  アラートメッセージ！
</p>
<script>
  const showBtn = document.getElementById("showAlert");
  const alertBox = document.getElementById("alert");
  showBtn.addEventListener("click", () => {
    alertBox.style.display = "block";
    setTimeout(() => {
      alertBox.style.display = "none";
    }, 3000);
  });
</script>

<br>

<!-- メールアドレス形式でなければエラーメッセージを表示
正しい形式ならエラーを消す
チェックは「入力のたびに」行う -->
<input type="text" id="email" placeholder="メールアドレス">
<p id="err" style="color:red;"></p>

<script>
const email = document.getElementById("email");
const err = document.getElementById("err");
email.addEventListener("input", () => {
  const value = email.value;
  const pattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

  if (!pattern.test(value)) {
    err.textContent = "正しいメール形式を入力してください";
  } else {
    err.textContent = "";
  }
});
</script>


<br>

<!-- モーダルの背景（黒い部分）をクリックすると閉じる
モーダル内の内容をクリックしても閉じない -->
<button id="open">開く</button>
<div id="modals" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5);">
  <div id="content" style="background:#fff; margin:100px auto; padding:20px; width:300px;">
    モーダルの内容
  </div>
</div>

<script>
const openBtn = document.getElementById("open");
const modals = document.getElementById("modals");
const content = document.getElementById("content");

//ボタンを押すとモーダルを表示
openBtn.addEventListener("click", () => {
  modals.style.display = "block"; //モーダル（背景ごと）を表示
});
//背景（黒い半透明背景）をクリックすると、モーダル全体を display: none にして非表示にする。
modals.addEventListener("click", () => {
  modals.style.display = "none";
});
// モーダルの中身をクリックしても閉じないようにする
content.addEventListener("click", (e) => {
  e.stopPropagation();
});
</script>

<!-- modal は「黒い半透明の背景」 -->
<!-- display: none → 最初は非表示（見えていない） -->
<!-- position: fixed → 画面に固定して全画面を覆う -->
<!-- inset: 0 → 上下左右ぜんぶ0 → 全画面の大きさ -->
<!-- background: rgba(0,0,0,0.5) → 黒い半透明背景 -->

<!-- content は中央の白いモーダル本体 -->

<br>

<!-- 仕様
input に数値を入力
「2倍にする」ボタンを押すと、結果を <p> に表示 -->

<input type="number" id="num" placeholder="数字を入力">
<button id="doubleBtn">2倍にする</button>
<p>結果：<span id="result">0</span></p>
<script>
  const num = document.getElementById("num");
  const doubleBtn = document.getElementById("doubleBtn");
  const result = document.getElementById("result");
  doubleBtn.addEventListener("click", () => {
    const value = Number(num.value);
    result.textContent = value * 2;
  });
</script>